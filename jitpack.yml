jdk:
  - openjdk17

install:
  # Point to JitPack's actual SDK dir
  - export ANDROID_SDK_ROOT=/opt/android-sdk-linux
  - export ANDROID_HOME=/opt/android-sdk-linux
  - export PATH="$ANDROID_SDK_ROOT/cmdline-tools/latest/bin:$ANDROID_SDK_ROOT/platform-tools:$PATH"

  # Ensure cmdline-tools exists first
  - mkdir -p "$ANDROID_SDK_ROOT/cmdline-tools"
  - yes | sdkmanager "cmdline-tools;latest" > /dev/null

  # Accept all licenses (now that cmdline-tools is installed)
  - yes | sdkmanager --licenses

  # Install what the build needs (adjust versions if you change Gradle/AGP)
  - sdkmanager \
    "platform-tools" \
    "platforms;android-36" \
    "build-tools;35.0.0" \
    "ndk;28.0.12433566"

  # Diagnostics (optional)
  - sdkmanager --list_installed || true
  - ls -la "$ANDROID_SDK_ROOT/licenses" || true

build:
  commands:
    # Make sure the version you pass matches what you want to publish
    - ./gradlew :eNROLL-sdk:publishToMavenLocal -Pgroup=com.github.LuminSoft -Pversion=1.4.9 --no-daemon --stacktrace
