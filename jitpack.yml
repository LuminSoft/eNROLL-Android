jdk:
  - openjdk17

install:
  - |
    export RAW_VERSION="${VERSION}"
    export CLEAN_VERSION="${RAW_VERSION#v}"
    export AAR_FILE="eNROLL-sdk-${CLEAN_VERSION}.aar"
    export POM_FILE="pom-${CLEAN_VERSION}.xml"
    echo "RAW_VERSION=$RAW_VERSION CLEAN_VERSION=$CLEAN_VERSION"
    echo "Downloading AAR: $AAR_FILE"
    curl -fL --retry 3 -o "$AAR_FILE" "https://github.com/LuminSoft/eNROLL-Android/releases/download/${RAW_VERSION}/${AAR_FILE}"
    ls -lh "$AAR_FILE"
    echo "Downloading POM: $POM_FILE"
    curl -fL --retry 3 -o "$POM_FILE" "https://github.com/LuminSoft/eNROLL-Android/releases/download/${RAW_VERSION}/${POM_FILE}"
    ls -lh "$POM_FILE"
    echo "Installing with POM dependencies..."
    mvn install:install-file -Dfile="$AAR_FILE" -DpomFile="$POM_FILE"
